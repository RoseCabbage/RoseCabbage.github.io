---
title: 正则表达式（入门）
date: 2018-04-05 16:34:30
tags:
- 正则表达式
- 计算机
categories:
- 计算机
---

![regular_expression-1](regular-expression-basic/regular_expression-1.png)

> 虽然早先就知道了正则表达式，但是一直没有详细的了解过（感觉是很高端的操作），但是又觉得会很有用（前提是掌握的很溜，否则可能错误不断），就去学习了一下，写此笔记。

<!--more--> 

## 正则表达式简介

### 什么是正则表达式

- 正则表达式，又称正规表示法、常规表示法(Regular Expression，简写为regex, regrep, RE)，是计算机科学的一个概念
- 正则表达式使用单个字符串来描述、匹配一系列符合某个句法规则的字符串
- 在很多文本编辑器里，正则表达式通常被用来检索、替换那些符合某个模式的字符串
- 字符串搜索和匹配的工具，通过正则表达式可以完成复杂的字符串操作

### 什么时候会用到正则表达式

- 数据验证
- 字符串查找
- 字符串替换

## 正则表达式基本语法

### 元字符

- `.`    匹配除换行符以外的任意字符
- `\w`  匹配字母或数字或下划线或汉字
- `\s`  匹配任意的空白符
- `\d`  匹配数字
- `\b`  匹配单词的开始或结束
- `^`    匹配字符串的开始
- `$`    匹配字符串的结束

元字符`^`和`$`都匹配一个位置，这和`\b`有点类似。`^`匹配你要用来查找的字符串的开头，`$`匹配结尾。这两个代码在验证输入的内容时非常有用，比如一个网站如果要求你填写的QQ号必须为5位到12位数字时，可以使用：`^\d{5,12}$`。

### 字符转义

如果想查找元字符本身的话，不能直接指定他们，需要使用`\` 来取消他们的特殊含义，比如`\.` 和`\*` 。

类似的，如果要查找`\` ，也需要用`\\` 。

### 重复

- `* `          重复零次或更多
- `+`          重复一次或更多
- `?`          重复零次或一次
- `{n}`      重复n次
- `{n,}`    重复n次或更多
- `{n,m}`  重复n次到m次

例子：

- `Windows\d+` 表示Windows后面跟着一个或更多的数字
- `^\w+` 匹配一行的第一个单词 

### 字符类

要想查找数字、字母和数字或者空白是很简单的（只要元字符就可以实现了），但是要匹配没有预定义元字符的字符集合（比如元音字母）光靠前面的元字符就不够了。

`[aeiou]` 可以匹配任何一个英文元音字母

`[.?!]` 匹配标点符号

`[0-9]` 的含义和 `\d` 完全一致，类似的，`[a-z0-9A-Z_] ` 等同于`\w` （如果只考虑英文）

`\(?0\d{2}[) -]?\d{8}` 可以匹配几种格式的电话号码：

- (010)88886666
- 022-22334455
- 02912345678

*首先是左括号出现零次或一次，然后是0，后面跟着两位数字，然后是右括号、空格、或者-中的一个或不出现，这之后是8个数字*

### 分枝条件

`\(?0\d{2}[) -]?\d{8}` 也能匹配不正确的格式（比如*010)12345678* ）

正则表达式里的分枝条件指的是**有几种规则，满足任一种规则都当成匹配**，具体方法是**用 | 把不同的规则分隔开**

例子：

- `0\d{2}-\d{8}|0\d{3}-\d{7}` 匹配两种格式，一种是3位区号8位本地号（010-88888888），一种是4位区号7位本地号（0571-7777777）
- `\(0\d{2}\)[- ]?\d{8}|0\d{2}[- ]?\d{8}` 匹配3位区号的电话号码，其中分枝条件表示三位区号可以用括号括起来，也可以不使用括号，但是括号必须成对出现
- `\d{5}-\d{4}|\d{5}` 匹配美国的邮政编码（5位数字或者-间隔的9位数字）

> 使用分枝条件一定要注意各个条件的顺序，如果调换上面第三个例子中的两个条件的顺序，那么只能匹配5位的邮编或者9位邮编的前5位，这样的原因是，**匹配分枝条件的时候，从左到右测试每个条件，一旦匹配就不会管其他的条件**

### 分组

分组的一个最基本的应用就是重复多个字符，使用的方法是用小括号指定**子表达式**，或者也称为**分组**。

例子

- `(\d{1,3}\.){3}\d{1,3}` 这是一个IP地址匹配的表达式，`\d{1,3}\.` 表示一位到三位数字后面跟着一个点号，用小括号括起来之后跟着`{3}` 表示这样的格式重复三次，最后再加上一位到三位的数字。
- 事实上这并不是一个正确的表达式，因为他也可以匹配到超过255的并不存在的IP地址，在这里举出这个例子只是说明分组的一种使用方法。
- `((2[0-4]\d|25[0-5]|[01]?\d\d?)\.){3}(2[0-4]\d|25[0-5]|[01]?\d\d?)` 才是正确的IP地址的匹配表达式

### 反义

反义指的是**不属于某个能简单定义的字符类的字符**

- `\W`  匹配任意不是字母或数字或下划线或汉字的字符
- `\S`  匹配任意不是的空白符的字符
- `\D`  匹配任意非数字字符
- `\B`  匹配不是单词的开始或结束的位置
- `[^x]`    匹配除了x以外的任意字符
- `[^aeiou]`  匹配除了元音字母以外的字符

### 后向引用

使用小括号指定一个子表达式后，**匹配这个子表达式的文本**可以在表达式或其它程序中作进一步的处理。默认情况下，每个分组会自动拥有一个组号，规则是：从左向右，以分组的左括号为标志，第一个出现的分组的组号为1，第二个为2，以此类推。

后向引用指的是搜索前面的某个分组的文本，其实也就是为了使得表达式更加简单，重复出现的不需要输入同样的表达式，而只需要用`\1` 这样的符号来简单的表示即可。

组号根据默认的条件会顺序用数字命名，但是我们也可以自定义：`(?<Name>\w+)`或者`(?'Name'\w+)` 

- 上述的两种方法得到的结果是一样的，都命名为Name
- 要反向引用的时候需要输入`\k<Name>`
- 如果要不捕获匹配的文本，方法是`(?:\w+)` ，这样就不会有组号了 

### 零宽断言

零宽断言是用来查找在某些内容之前或者之后的内容

- `(?=exp)`     匹配exp前面的位置
- `(?<=exp)`   匹配exp后面的位置
- `(?!exp)`     匹配后面不是exp的位置
- `(?<!exp)`   匹配前面不是exp的位置

具体来说，`(?=exp)` 是零宽度正预测先行断言，断言自身出现的位置后面能匹配表达式exp，例如`\b\w+(?=ing\b)` 查找的是ing形式的动词

`(?<=exp)`是零宽度正回顾后发断言

### 负向零宽断言

零宽度负预测先行断言`(?!exp)` 

- `\d{3}(?!\d)` 匹配三位数字，并且三位数字之后不能是数字
- `\b((?!abc)\w)+\b` 匹配不包含连续字符串abc的单词

零宽度负回顾后发断言`(?<!exp)`

- `(?<![a-z])\d{7}` 匹配前面不是小写字母的数字7

### 注释

`(?#comment)` 即可包含注释

### 贪婪与懒惰

#### 贪婪

当正则表达式中包含能接受重复的限定符时，通常的行为是（在使整个表达式能得到匹配的前提下）匹配**尽可能多**的字符。这被称为贪婪匹配。

#### 懒惰

类似的，懒惰匹配指的是匹配尽可能少的字符。

前面提到的限定符都可以转化为懒惰匹配模式

使用方法是在他后面加上一个问号**?**

`.*?` 表示的任意数量的重复，但是使用最少的重复   

## 总结

上面的这些只是正则表达式最基础的一些内容，非常感谢[正则表达式30分钟入门教程](http://deerchao.net/tutorials/regex/regex.htm)花费我绝对不止三十分钟才对正则表达式有了很基础的了解。 

